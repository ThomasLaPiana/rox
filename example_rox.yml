# This is a target for eventual language support
# Example usage: rox docker_build
# Example usage in parallel: rox -p docker_build black

supplemental_files: ["someotherfile.yml"]
rox_version: 1.3

# These checks require a single, well-formed SemVer version string as output from the command
version_requirements:
  - command: "docker version --format {{.Client.Version}}"
    minimum_version: ["20.10.7"]
    maximum_version: ["21.0.0"]

  - command: "python --version"
    versions: ["*"] # Any version will do, verifies the tool is available

file_requirements:
  - path: ".env"

commands:

  # rox docker_build -foo dev
  # rox docker_build -foo prod
  # rox docker_build
  - name: docker_build
    parameters:
      - symbol: foo # Rox will look for and replace $foo in both the command and arguments
        values: ["prod", "dev"]
    command: "docker"
    arguments: ["--target", "$foo", ".", "--quiet"]
    
  - name: isort
    command: isort

  - name: black
    command: black
    arguments: ["src"]

  - name: format
    depends_on: ["black, isort"] # This order is preserved, unless run with the `-p` flag
